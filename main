#include <iostream>
using namespace std;

void hacertablero(char **&matriz,int estilo,int a){
    char str1[] = " ";
    int nfilas=1;
    int ncolu=1;
    if (estilo==7){
        for (int i=0; i<8; i++) {
            for (int j = 0; j < 8; j++) {
                if (i == 0 && j == 0) {
                    matriz[i][j] = str1[0];
                } else if (i == 4 && j == 4) {
                    matriz[i][j] = '+';
                } else if (i == 0 && j != 0) {
                    matriz[i][j] = nfilas + '0';
                    nfilas = nfilas + 1;
                } else if (j == 0 && i != 0) {
                    matriz[i][j] = ncolu + '0';
                    ncolu = ncolu + 1;
                } else if (i == 1 && j == 1 || i == 1 && j == 2 || i == 2 && j == 1 || i == 2 && j == 2 ||
                           i == 6 && j == 1 || i == 6 && j == 2 || i == 7 && j == 1 || i == 7 && j == 2 ||
                           i == 1 && j == 6 || i == 1 && j == 7 || i == 2 && j == 6 || i == 2 && j == 7 ||
                           i == 6 && j == 6 || i == 6 && j == 7 || i == 7 && j == 6 || i == 7 && j == 7) {
                    matriz[i][j] = str1[0];
                } else {
                    matriz[i][j] = '0';
                }

            }
            cout << endl;
        }
    }
    else if (estilo==9&&a==0){
        for (int i=0; i<10; i++) {
            for (int j = 0; j < 10; j++) {
                if (i == 0 && j == 0) {
                    matriz[i][j] = str1[0];
                } else if (i == 5 && j == 5) {
                    matriz[i][j] = '+';
                } else if (i == 0 && j != 0) {
                    matriz[i][j] = nfilas + '0';
                    nfilas = nfilas + 1;
                } else if (j == 0 && i != 0) {
                    matriz[i][j] = ncolu + '0';
                    ncolu = ncolu + 1;
                } else if (i == 1 && j == 1 || i == 1 && j == 2 || i == 1 && j == 3 || i == 2 && j == 1 || i == 2 && j == 2 || i == 2 && j == 3 || i == 3 && j == 1 || i == 3 && j == 2 || i == 3 && j == 3 ||
                           i == 7 && j == 1 || i == 7 && j == 2 || i == 7 && j == 3 || i == 8 && j == 1 || i == 8 && j == 2 || i == 8 && j == 3 || i == 9 && j == 1 || i == 9 && j == 2 || i == 9 && j == 3 ||
                           i == 1 && j == 7 || i == 1 && j == 8 || i == 1 && j == 9 || i == 2 && j == 7 || i == 2 && j == 8 || i == 2 && j == 9 || i == 3 && j == 7 || i == 3 && j == 8 || i == 3 && j == 9 ||
                           i == 7 && j == 7 || i == 7 && j == 8 || i == 7 && j == 9 || i == 8 && j == 7 || i == 8 && j == 8 || i == 8 && j == 9 || i == 9 && j == 7 || i == 9 && j == 8 || i == 9 && j == 9 ) {
                    matriz[i][j] = str1[0];
                } else {
                    matriz[i][j] = '0';
                }

            }
            cout << endl;
        }

    }
    else if (estilo==9&&a==1){
        for (int i=0; i<10; i++) {
            for (int j = 0; j < 10; j++) {
                if (i == 0 && j == 0) {
                    matriz[i][j] = str1[0];
                } else if (i == 5 && j == 5) {
                    matriz[i][j] = '+';
                } else if (i == 0 && j != 0) {
                    matriz[i][j] = nfilas + '0';
                    nfilas = nfilas + 1;
                } else if (j == 0 && i != 0) {
                    matriz[i][j] = ncolu + '0';
                    ncolu = ncolu + 1;
                } else if (i == 1 && j == 1 || i == 1 && j == 2 || i == 1 && j == 3 || i == 1 && j == 4 || i == 2 && j == 1 || i == 2 && j == 2 || i == 2 && j == 3 || i == 3 && j == 1 || i == 3 && j == 2 || i == 4 && j == 1 ||
                           i == 6 && j == 1 || i == 7 && j == 1 || i == 7 && j == 2 || i == 8 && j == 1 || i == 8 && j == 2 || i == 8 && j == 3 || i == 9 && j == 1 || i == 9 && j == 2 || i == 9 && j == 3 || i == 9 && j == 4 ||
                           i == 1 && j == 6 || i == 1 && j == 7 || i == 1 && j == 8 || i == 1 && j == 9 || i == 2 && j == 7 || i == 2 && j == 8 || i == 2 && j == 9 || i == 3 && j == 8 || i == 3 && j == 9 || i == 4 && j == 9 ||
                           i == 6 && j == 6 || i == 7 && j == 8 || i == 7 && j == 9 || i == 8 && j == 7 || i == 8 && j == 8 || i == 8 && j == 9 || i == 9 && j == 6 || i == 9 && j == 7 || i == 9 && j == 8 || i == 9 && j == 9 ) {
                    matriz[i][j] = str1[0];
                } else {
                    matriz[i][j] = '0';
                }

            }
            cout << endl;
        }

    }


}

int validarficha(int f,int c,char **&matriz){
    if(matriz[f][c]=='0'){
        return(1);
    }
    else{
        return(0);
    }
}

int validarmovimiento(int fichaf,int  fichac,int  movf,int movc,char **&matriz){
    if(matriz[movf][movc]=='+'){
        if(fichaf+2==movf && fichac==movc && matriz[fichaf+1][fichac]=='0'){
            return(1);
        }
        else if(fichaf-2==movf && fichac==movc && matriz[fichaf-1][fichac]=='0'){
            return(2);
        }
        else if(fichaf==movf && fichac+2==movc && matriz[fichaf][fichac+1]=='0'){
            return(3);
        }
        else if(fichaf==movf && fichac-2==movc && matriz[fichaf][fichac-1]=='0'){
            return(4);
        }
        else{
            return(0);
        }
    }
    else if(movf==9&&movc==9){
        return(9);
    }
    else{
        return(0);
    }
}

void mover(int validm,int fichaf,int  fichac,int  movf,int movc,char **&matriz){
    char a;
    a=matriz[fichaf][fichac];
    matriz[fichaf][fichac]=matriz[movf][movc];
    matriz[movf][movc]=a;
    if (validm==1){
        matriz[fichaf+1][fichac]='+';
    }
    else if(validm==2){
        matriz[fichaf-1][fichac]='+';
    }
    else if(validm==3){
        matriz[fichaf][fichac+1]='+';
    }
    else if(validm==4){
        matriz[fichaf][fichac-1]='+';
    }
}

int cuentafichas(char **&matriz, int estilo){
    int fila, columna, a = 0;

    for (fila= 0; fila < estilo; fila++)
    {
        for (columna = 0; columna < estilo; columna++)
        {
            if(matriz[fila][columna] == '0')
            {
                a++;
            }
        }
    }

    if (a == 1){
        return (1);
    }
    else{
        return(0);
    }
}

void imprimir(char **&matriz,int estilo){
    for (int i = 0; i < estilo; i++) {
        for (int j = 0; j < estilo; j++) {
            cout << matriz[i][j] << " ";
        }
        cout << endl;
    }
}

void menu(char **&matriz,int estilo,int a) {
    int x, fichaf, fichac, movf, movc, ganado, validf, validm;
    hacertablero(matriz,estilo,a);
    cout << "********BIENVENIDOS A SENKU*********" << endl;
    cout << "Ingresar 1 si quieren jugar o 2 si quieren salir " << endl;
    cin >> x;
    cout << "Si quieres parar el juego en cualquier momento colocar 9 en todos los parametros"<<endl;
    if (x == 1) {
        imprimir(matriz,estilo);
    } else if (x == 2) {
        cout << "Hasta pronto";
    }
    ganado=cuentafichas(matriz,estilo);
    while (ganado != 1) {
        cout << "Ingresa ficha a mover:" << endl;
        cout << "Fila: ";
        cin >> fichaf;
        cout << "Columna: ";
        cin >> fichac;
        if(fichaf==9 && fichac==9){
            cout<<"termino el juego";
            break;
        }
        validf = validarficha(fichaf, fichac, matriz);
        if (validf == 1) {
            cout << "Ficha valida"<<endl;
            cout << "Ingresar fila a mover: ";
            cin >> movf;
            cout << "Ingresar columna a mover: ";
            cin >> movc;
            validm=validarmovimiento(fichaf, fichac, movf, movc, matriz);
            if(validm == 1||validm == 2||validm == 3||validm == 4) {
                cout << "Movimiento valido" << endl;
                mover(validm, fichaf, fichac, movf, movc, matriz);
                imprimir(matriz,estilo);
            }
            else if(validm == 9){
                cout<<"termino el juego";
                break;
            }
            else{
                cout << "Movimiento invalido"<<endl;
            }
        }
        else{
            cout << "Ficha invalida"<<endl;
        }
    }
    if(ganado == 1){
        cout << " HAS GANADO !!!!!! Felicitaciones";
    }
}

int main(){
    int estilo,a=0;
    char **matriz = nullptr;
    cout << "Menu Juego Senku"<< endl;
    cout << "-----------------" << endl;
    cout << "1. Estilo Aleman" << endl;
    cout << "2. Estilo Ingles" << endl;
    cout << "3. Estilo Diamante" << endl;
    cout << "--------------------" << endl;
    cout << "0. Salir del juego" << endl;
    cin >> estilo;
    if ( estilo == 0){
        cout << "Vuelva pronto" << endl;
    }
    else if (estilo == 1){
        estilo=estilo+8;
        matriz = new char*[estilo];
        for(int i = 0; i < estilo; i++){
            matriz[i] = new char[estilo];
        }
        menu(matriz,estilo,a);
    }
    else if (estilo == 2){
        estilo=estilo+5;
        matriz = new char*[estilo];
        for(int i = 0; i < estilo; i++){
            matriz[i] = new char[estilo];
        }
        menu(matriz,estilo,a);
    }
    else if (estilo == 3){
        a=a+1;
        estilo=estilo+6;
        matriz = new char*[estilo];
        for(int i = 0; i < estilo; i++){
            matriz[i] = new char[estilo];
        }
        menu(matriz,estilo,a);
    }
    else{
        cout << "Regresa pronto"<<endl;
    }
    return 0;
}
